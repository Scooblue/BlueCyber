<h1>Overview</h1>
<p> I want to start this report off by saying that, I am going into this blind as it is my first vulnerability assesssment I am performing. I only have theoretical knowledge on this topic. I asm going to be setting up a virtualized network attempting to simulate a small-to-medium business's network. I will document and report the general blueprint of the network and provide visuals along the way. I believe I will be using Qualys for vulnerability scanning, and remediation. Additionally, The overall report and the actual remediation, patching, etc. will be documented in a seperate document. This will be strictly a report based around a scenario where I was to perform a consultation as a third-party. I believe I will in the future doing some risk assessments, some compliancy audits as well as some physical security audits using real world businesses as examples. I digress, This document will strictly be the report and then I will outline and document the fixes, remediation, etc. in another document.</p>
<h4>Update</h4>
<p>With the limited resources I have at the moment, I decided to actually start smaller, for this exercise I am going to be focusing on one end point device on a hypothetical network, I realized my scope was too big to begin with 
for the amount of money and hardware I personally own. I will revisit this larger scope in a lab later down the road, perhaps after I get some more money and access to resources to set it up as I want without hardware limitations. </p>

<h1>Structure</h1>
<p>I believe structuring this report into six sections makes the most logical sense, they go as followed: </p>
<p>1. Executive Summary</p>
<p>2. Scan Results</p>
<p>3. Methodology</p>
<p>4. Findings</p>
<p>5. Risk Assessment</p>
<p>6. Recommendations</p>

<h1>Executive Summary</h1>
<p>The dates that this vulnerability assessment has taken place, Start:<b>07/29/24</b> to End:<b>07/29/24</b></p>
<p><b>Scope of this assessment:</b> The scope of this assessment is restricted to the one theoretical user end point device, I have downloaded the  jangow01.ova vm file off of vulhub for this exercise which will be the vulnerable system used in this assessment</p> 
<p>The assessment has been concluded; futhermore, overall risk for the client is categorized as severe upon completion of the assessment if I had to provide a rating out of 10 the risk this system poses is a 10/10</p>
<p>Disclaimer</p>

<h1>Scan Results</h1>

<p>Screen capture of the Vulnerability Scans results for the jangow01 virtual machine</p>

![vulnandpotential](https://github.com/user-attachments/assets/74246842-7470-4645-92f9-16759c573799)

<p>Results can be broken down into two categories.</p>
<p>1. Confirmed Vulnerabilities<br><br>
There are four such vulnerabilities confirmed on this machine, two of which are of primary concern<br>
<b>a.FTP not requiring encrypted credentials</b>. i.e. plaintext(unencrypted) data in transit is susceptible to MitM, Sniffing, Replay attacks, and Tampering, this threatens both integrity and confidentiality, ultimitely utilizing secure protocols which have strong industry standard encryption is pivitol, I recommend ECC-384bit or minimum RSA-4096bit for data encryption.<br><br>
Additionally, remediation for this vulnerability can be addressed through switching from FTP to SFTP, the secure file transfer protocol.<br><br>
<b>b.No HTTP Security Header absense of X-Content-Type-Options:nosniffer && HSTS</b><br>
Qualys only lists this vulnerability as a 2/5, but I believe it should be rated higher as a vulnerability since the absense of HSTS means that all requests between client and server will be conducted through http rather then https, this means that all communication is unencrypted, and susceptible to a lot of the same things as the FTP server is as previously stated.<br><br>
Additionally, the lack of the X-Content-Type header which is meant to prevent MIME type sniffing, means that this system could be vulnerable to MIME type confusion leading to XSS and remote code execution. </p>

<p>2. Potential Vulnerabilities</p>
<p>There are 20 Potential Vulnerabilities identified within the scan, I believe that most if not all of them are legitimate vulnerabilities to this system. Why? Looking at the version of Apache that the clients machine runs on, it is severely outdated, (Apache2.4.18), according to the date 07/17/24, Apache2.4.62 is the latest. Many of these vulnerabilities leave possibility for remote code execution, denial of service and in general compromising the safety of the CIA triade in regards to the data contained in the Apache server.</p>

<h1>Methodology</h1>
<p>The methodology of this assessment can be divided into two stages<br><br>
1. Qualys Cloud-based vulnerability scan<br><br>
  
The purpose of this scan: to identify existing and potential vulnerabilties, to enumerate versioning, and open/closed ports<br>
Furthermore, the analysis and intepretation of this scan, proved excellent at exposing all critical vulnerabilities and giving direction to prioritization of the penetration testing<br>

2. Transferring the enumeration of information from the vulnerability scan into a Web Application-Based Penetration Test<br><b>

The purpose of this Penetration Test is to attempt to exploit the potential remote code execution vulnerabilitiy and compromise the data stored on the Apache server to ultimately gain control over the clients system (Apache server aka jangow01)<br><br>

The penetration test was undertaken with the predominate use of the web application security tool "Burp-Suite", utilized to test remote code execution<br>
The environment for the use of burp-suite was on my local system (debian 12) parrot-os
  
</p>

<h1>Findings</h1>
<p>All systems were successfully scanned, tested, and assessed. In this case it was the lone end point(jangow01 running Apache)<br><br>

Utilizing Burp-Suite, I was able to remotely execute GET requests to the server and acquire data such as login credentials

![webexploit-remotecode](https://github.com/user-attachments/assets/971bdf10-fc0c-4c0b-86a9-2860503d99d6)

In the photo above I got the userflag associated with this virtual machine, but right after I edited the request to display the wordpress configuration file<br><br>
I changed the request to "GET site/busque.php?buscar=cat%20wordpress/config.php" and forwarded it to the Apache server which then outputted the contents of the config file,<br><br>
username:jangow01<br>
password:abygurl69<br><br>
with that information  is able to access the machine or download files via FTP remotely. 
</p>

<h1>Risk Assessment</h1>
<p>Below is a list and Description of the levels and severity of vulnerabilities with an in-depth explanation.</p>

![vulnlevels](https://github.com/user-attachments/assets/534528c8-0c4a-4043-adcc-4cbec8febac5)


<h3><ins>Index of all Identified Vulnerabilities Categorized on Severity</ins></h3>

<p> Urgent/Critical Severity Vulnerabilities<br>
   	Apache httpd Server Uninitialized memory reflection in mod_auth_digest Information Disclosure Vulnerability| Severity 5/5<br> 
    Apache Hypertext Transfer Protocol Server (HTTP Server) mod_proxy X-Forwarded-For dropped by hop-by-hop mechanism Vulnerability| Severity 5/5<br> 
    Apache Hypertext Transfer Protocol Server (HTTP Server) Multiple Security Vulnerabilities (CVE-2022-28330, CVE-2022-28614, CVE-2022-28615, CVE-2022-29404, CVE-2022-30556)| Severity 5/5
    
  
  <br><br>
  
High Severity Vulnerabilities<br>

   Apache HTTP Server mod_mime Buffer Overread|Severity 4/5<br>
   	Apache HTTP Server Multiple Vulnerabilities|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol Server (HTTP Server) Multiple Vulnerabilities|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol (HTTP) Server NULL Pointer Dereference and Server Side Request Forgery (SSRF)      Vulnerability|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol (HTTP) Server Out-of-bounds Write Vulnerability|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol (HTTP) Server Request Smuggling Vulnerability|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol Server (HTTP Server) Prior to 2.4.55 Multiple Security Vulnerabilities|            Severity 4/5<br>
   	Apache Hypertext Transfer Protocol Server (HTTP Server) Prior to 2.4.58 Multiple Security Vulnerabilities|     Severity 4/5<br>
   	Apache Hypertext Transfer Protocol Server (HTTP Server) Request Smuggling Vulnerability (CVE-2022-36760)|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol Server (HTTP Server) Request Smuggling Vulnerability (CVE-2022-26377)|Severity 4/5<br>
   	Apache Hypertext Transfer Protocol Server (HTTP Server) Prior to 2.4.60 Multiple Security Vulnerabilities|Severity 4/5 
<br><br>
    
Medium Severity Vulnerabilities<br>

Remote Management Service Accepting Unencrypted Credentials Detected (FTP)|Severity 3/5<br>
 	TCP Sequence Number Approximation Based Denial of Service|Severity 3/5<br>
 	Apache HTTP Server multiple vulnerabilities|Severity 3/5<br>
 	Apache HTTP Server CRLF Injection Vulnerability (CVE-2016-4975)|Severity 3/5<br>
 	Apache Hypertext Transfer Protocol Server (HTTP Server) Multiple Security Vulnerabilities (CVE-2023-38709, CVE-2024-24795)|Severity 3/5<br>
 	VSFTPD Denial of Service (DoS) Vulnerability|Severity 3/5
<br><br>

Low Severity Vulnerabilities<br>

 HTTP Security Header Not Detected|Severity 2/5<br>
Web Directories Listable Vulnerability|Severity 2/5<br>
 Apache Hypertext Transfer Protocol Server (HTTP Server) HTTP/2 Method Injection Vulnerability|Severity 2/5

<br><br>

<h3>Remediation of Vulnerabilities</h3>
<p>The Remediation of 21 of the 24 identified vulnerabilities can be easily deployed through updating Apache to the latest version (Apache2.4.62)</p><br>
<p>Adding the http security headers, switching to https, and sftp (the secure encrypted protocols) would remediate the rest of the vulnerabilities<br><br>
  
when both of these two methods are employed, the clients effected system will no longer experience any of these identified vulnerabilties and be generally secure.</p>
  
</p>

<h1>Recommendations</h1>
<p></p>
